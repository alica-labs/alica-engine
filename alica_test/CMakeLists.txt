cmake_minimum_required(VERSION 2.8.3)
project(alica_test)

## Use c++ 11x std
set(CMAKE_CXX_FLAGS "-std=c++11 ${CMAKE_CXX_FLAGS}")
if (${CMAKE_EXTRA_GENERATOR} MATCHES "Eclipse CDT4")
	set(CMAKE_CXX_COMPILER_ARG1 "-std=c++11" CACHE STRING "C++ version for eclipse" FORCE)
	set(CMAKE_ECLIPSE_VERSION "4.5" CACHE STRING "Eclipse version" FORCE)
	add_definitions (-DCMAKE_ECLIPSE_GENERATE_SOURCE_PROJECT=TRUE)
endif (${CMAKE_EXTRA_GENERATOR} MATCHES "Eclipse CDT4")

find_package(catkin REQUIRED COMPONENTS 
    roscpp 
    system_config 
    fsystem 
    autodiff 
    constraintsolver 
    event_handling 
    alica_engine 
    alica_ros_proxy 
    alica_dummy_proxy
)

catkin_package(
  INCLUDE_DIRS autogenerated/include
  LIBRARIES autogen_code 
  CATKIN_DEPENDS alica_engine alica_ros_proxy alica_dummy_proxy
)

file(GLOB_RECURSE test_alica_SOURCES "src/test/*.cpp")
catkin_add_gtest(${PROJECT_NAME}-test ${test_alica_SOURCES})

if(TARGET ${PROJECT_NAME}-test)
 include_directories(autogenerated/include ${catkin_INCLUDE_DIRS})
 file(GLOB_RECURSE autogen_SOURCES "autogenerated/src/*.cpp")
 add_library(autogen_code
	${autogen_SOURCES};
 ) 
 target_link_libraries(autogen_code ${catkin_LIBRARIES})

 target_link_libraries(${PROJECT_NAME}-test ${catkin_LIBRARIES} autogen_code )
endif()

